import { AddressLike, BigNumberish } from "ethers";
import { keccak256 } from "js-sha3";
import { ethers } from "hardhat";

const { expect } = require("chai");



describe("evm-verifier", function () {
  it("Verify a ring signature", async function () {
    // link libraries
    const contractFactory = await ethers.getContractFactory("RingSigVerifier");

    // deploy SigVerifier contract
    const SigVerifier = await contractFactory.deploy();

    const message = BigInt("0x" + "1ac7d1b81b7ba1025b36ccb86723da6ee5a87259f1c2fd5abe69d3200b512ec8");
    console.log("messageDigest: ", message);
    const ring_: BigNumberish[] = [
      30103554500144535254965021336757008479704861502777924021458799636567575289359n, 52090609727678693574435399254703833889410700116234244177206170117175907888773n,
      30558939714202291090863029727820829993227403204286654734430544819396481281155n, 46835398937525857424678912804713110217248423408711238708095319128726301404767n,
      36527336516757141982692764653028488263347504639791543174831352430519439297986n, 15011237199815729085619642936750715774280631056461653359383019129472793929103n,
      15164162595175125008547705889856181828932143716710538299042410382956573856362n, 20165396248642806335661137158563863822683438728408180285542980607824890485122n,
      30103554500144535254965021336757008479704861502777924021458799636567575289359n, 52090609727678693574435399254703833889410700116234244177206170117175907888773n,
      30558939714202291090863029727820829993227403204286654734430544819396481281155n, 46835398937525857424678912804713110217248423408711238708095319128726301404767n,
      36527336516757141982692764653028488263347504639791543174831352430519439297986n, 15011237199815729085619642936750715774280631056461653359383019129472793929103n,
      15164162595175125008547705889856181828932143716710538299042410382956573856362n, 20165396248642806335661137158563863822683438728408180285542980607824890485122n,
      30103554500144535254965021336757008479704861502777924021458799636567575289359n, 52090609727678693574435399254703833889410700116234244177206170117175907888773n,
      30558939714202291090863029727820829993227403204286654734430544819396481281155n, 46835398937525857424678912804713110217248423408711238708095319128726301404767n,
      36527336516757141982692764653028488263347504639791543174831352430519439297986n, 15011237199815729085619642936750715774280631056461653359383019129472793929103n,
      15164162595175125008547705889856181828932143716710538299042410382956573856362n, 20165396248642806335661137158563863822683438728408180285542980607824890485122n,
      30103554500144535254965021336757008479704861502777924021458799636567575289359n, 52090609727678693574435399254703833889410700116234244177206170117175907888773n,
      30558939714202291090863029727820829993227403204286654734430544819396481281155n, 46835398937525857424678912804713110217248423408711238708095319128726301404767n,
      36527336516757141982692764653028488263347504639791543174831352430519439297986n, 15011237199815729085619642936750715774280631056461653359383019129472793929103n,
      15164162595175125008547705889856181828932143716710538299042410382956573856362n, 20165396248642806335661137158563863822683438728408180285542980607824890485122n,
      30103554500144535254965021336757008479704861502777924021458799636567575289359n, 52090609727678693574435399254703833889410700116234244177206170117175907888773n,
      30558939714202291090863029727820829993227403204286654734430544819396481281155n, 46835398937525857424678912804713110217248423408711238708095319128726301404767n,
      36527336516757141982692764653028488263347504639791543174831352430519439297986n, 15011237199815729085619642936750715774280631056461653359383019129472793929103n,
      15164162595175125008547705889856181828932143716710538299042410382956573856362n, 20165396248642806335661137158563863822683438728408180285542980607824890485122n,
      30103554500144535254965021336757008479704861502777924021458799636567575289359n, 52090609727678693574435399254703833889410700116234244177206170117175907888773n,
      30558939714202291090863029727820829993227403204286654734430544819396481281155n, 46835398937525857424678912804713110217248423408711238708095319128726301404767n,
      36527336516757141982692764653028488263347504639791543174831352430519439297986n, 15011237199815729085619642936750715774280631056461653359383019129472793929103n,
      15164162595175125008547705889856181828932143716710538299042410382956573856362n, 20165396248642806335661137158563863822683438728408180285542980607824890485122n,
      30103554500144535254965021336757008479704861502777924021458799636567575289359n, 52090609727678693574435399254703833889410700116234244177206170117175907888773n,
      30558939714202291090863029727820829993227403204286654734430544819396481281155n, 46835398937525857424678912804713110217248423408711238708095319128726301404767n,
      36527336516757141982692764653028488263347504639791543174831352430519439297986n, 15011237199815729085619642936750715774280631056461653359383019129472793929103n,
      15164162595175125008547705889856181828932143716710538299042410382956573856362n, 20165396248642806335661137158563863822683438728408180285542980607824890485122n,
      30103554500144535254965021336757008479704861502777924021458799636567575289359n, 52090609727678693574435399254703833889410700116234244177206170117175907888773n,
      30558939714202291090863029727820829993227403204286654734430544819396481281155n, 46835398937525857424678912804713110217248423408711238708095319128726301404767n,
      36527336516757141982692764653028488263347504639791543174831352430519439297986n, 15011237199815729085619642936750715774280631056461653359383019129472793929103n,
      15164162595175125008547705889856181828932143716710538299042410382956573856362n, 20165396248642806335661137158563863822683438728408180285542980607824890485122n,
      30103554500144535254965021336757008479704861502777924021458799636567575289359n, 52090609727678693574435399254703833889410700116234244177206170117175907888773n,
      30558939714202291090863029727820829993227403204286654734430544819396481281155n, 46835398937525857424678912804713110217248423408711238708095319128726301404767n,
      36527336516757141982692764653028488263347504639791543174831352430519439297986n, 15011237199815729085619642936750715774280631056461653359383019129472793929103n,
      15164162595175125008547705889856181828932143716710538299042410382956573856362n, 20165396248642806335661137158563863822683438728408180285542980607824890485122n,
      30103554500144535254965021336757008479704861502777924021458799636567575289359n, 52090609727678693574435399254703833889410700116234244177206170117175907888773n,
      30558939714202291090863029727820829993227403204286654734430544819396481281155n, 46835398937525857424678912804713110217248423408711238708095319128726301404767n,
      36527336516757141982692764653028488263347504639791543174831352430519439297986n, 15011237199815729085619642936750715774280631056461653359383019129472793929103n,
      15164162595175125008547705889856181828932143716710538299042410382956573856362n, 20165396248642806335661137158563863822683438728408180285542980607824890485122n,
      30103554500144535254965021336757008479704861502777924021458799636567575289359n, 52090609727678693574435399254703833889410700116234244177206170117175907888773n,
      30558939714202291090863029727820829993227403204286654734430544819396481281155n, 46835398937525857424678912804713110217248423408711238708095319128726301404767n,
      36527336516757141982692764653028488263347504639791543174831352430519439297986n, 15011237199815729085619642936750715774280631056461653359383019129472793929103n,
      15164162595175125008547705889856181828932143716710538299042410382956573856362n, 20165396248642806335661137158563863822683438728408180285542980607824890485122n,
      30103554500144535254965021336757008479704861502777924021458799636567575289359n, 52090609727678693574435399254703833889410700116234244177206170117175907888773n,
      30558939714202291090863029727820829993227403204286654734430544819396481281155n, 46835398937525857424678912804713110217248423408711238708095319128726301404767n,
      36527336516757141982692764653028488263347504639791543174831352430519439297986n, 15011237199815729085619642936750715774280631056461653359383019129472793929103n,
      15164162595175125008547705889856181828932143716710538299042410382956573856362n, 20165396248642806335661137158563863822683438728408180285542980607824890485122n,
      30103554500144535254965021336757008479704861502777924021458799636567575289359n, 52090609727678693574435399254703833889410700116234244177206170117175907888773n,
      30558939714202291090863029727820829993227403204286654734430544819396481281155n, 46835398937525857424678912804713110217248423408711238708095319128726301404767n,
      36527336516757141982692764653028488263347504639791543174831352430519439297986n, 15011237199815729085619642936750715774280631056461653359383019129472793929103n,
      15164162595175125008547705889856181828932143716710538299042410382956573856362n, 20165396248642806335661137158563863822683438728408180285542980607824890485122n,
      30103554500144535254965021336757008479704861502777924021458799636567575289359n, 52090609727678693574435399254703833889410700116234244177206170117175907888773n,
      30558939714202291090863029727820829993227403204286654734430544819396481281155n, 46835398937525857424678912804713110217248423408711238708095319128726301404767n,
      36527336516757141982692764653028488263347504639791543174831352430519439297986n, 15011237199815729085619642936750715774280631056461653359383019129472793929103n,
      15164162595175125008547705889856181828932143716710538299042410382956573856362n, 20165396248642806335661137158563863822683438728408180285542980607824890485122n,
      30103554500144535254965021336757008479704861502777924021458799636567575289359n, 52090609727678693574435399254703833889410700116234244177206170117175907888773n,
      30558939714202291090863029727820829993227403204286654734430544819396481281155n, 46835398937525857424678912804713110217248423408711238708095319128726301404767n,
      36527336516757141982692764653028488263347504639791543174831352430519439297986n, 15011237199815729085619642936750715774280631056461653359383019129472793929103n,
      15164162595175125008547705889856181828932143716710538299042410382956573856362n, 20165396248642806335661137158563863822683438728408180285542980607824890485122n,
      30103554500144535254965021336757008479704861502777924021458799636567575289359n, 52090609727678693574435399254703833889410700116234244177206170117175907888773n,
      30558939714202291090863029727820829993227403204286654734430544819396481281155n, 46835398937525857424678912804713110217248423408711238708095319128726301404767n,
      36527336516757141982692764653028488263347504639791543174831352430519439297986n, 15011237199815729085619642936750715774280631056461653359383019129472793929103n,
      15164162595175125008547705889856181828932143716710538299042410382956573856362n, 20165396248642806335661137158563863822683438728408180285542980607824890485122n,
      30103554500144535254965021336757008479704861502777924021458799636567575289359n, 52090609727678693574435399254703833889410700116234244177206170117175907888773n,
      30558939714202291090863029727820829993227403204286654734430544819396481281155n, 46835398937525857424678912804713110217248423408711238708095319128726301404767n,
      36527336516757141982692764653028488263347504639791543174831352430519439297986n, 15011237199815729085619642936750715774280631056461653359383019129472793929103n,
      15164162595175125008547705889856181828932143716710538299042410382956573856362n, 20165396248642806335661137158563863822683438728408180285542980607824890485122n,
      30103554500144535254965021336757008479704861502777924021458799636567575289359n, 52090609727678693574435399254703833889410700116234244177206170117175907888773n,
      30558939714202291090863029727820829993227403204286654734430544819396481281155n, 46835398937525857424678912804713110217248423408711238708095319128726301404767n,
      36527336516757141982692764653028488263347504639791543174831352430519439297986n, 15011237199815729085619642936750715774280631056461653359383019129472793929103n,
      15164162595175125008547705889856181828932143716710538299042410382956573856362n, 20165396248642806335661137158563863822683438728408180285542980607824890485122n,
    ];

    const responses: BigNumberish[] = [
      15124591556122426477309540660897919468857997846316639835491587319990778094553n,
      35414148408193423211735462210279743496150383633088801277383073160916938493843n,
      34878991678064119169442084900553828397218924682387406243917099230599401148780n,
      45346946315156029274559984727839893164095325411430702636442359717481210321511n,
      15124591556122426477309540660897919468857997846316639835491587319990778094553n,
      35414148408193423211735462210279743496150383633088801277383073160916938493843n,
      34878991678064119169442084900553828397218924682387406243917099230599401148780n,
      45346946315156029274559984727839893164095325411430702636442359717481210321511n,
      15124591556122426477309540660897919468857997846316639835491587319990778094553n,
      35414148408193423211735462210279743496150383633088801277383073160916938493843n,
      34878991678064119169442084900553828397218924682387406243917099230599401148780n,
      45346946315156029274559984727839893164095325411430702636442359717481210321511n,
      15124591556122426477309540660897919468857997846316639835491587319990778094553n,
      35414148408193423211735462210279743496150383633088801277383073160916938493843n,
      34878991678064119169442084900553828397218924682387406243917099230599401148780n,
      45346946315156029274559984727839893164095325411430702636442359717481210321511n,
      34878991678064119169442084900553828397218924682387406243917099230599401148780n,
      45346946315156029274559984727839893164095325411430702636442359717481210321511n,
      15124591556122426477309540660897919468857997846316639835491587319990778094553n,
      35414148408193423211735462210279743496150383633088801277383073160916938493843n,
      34878991678064119169442084900553828397218924682387406243917099230599401148780n,
      45346946315156029274559984727839893164095325411430702636442359717481210321511n,
      15124591556122426477309540660897919468857997846316639835491587319990778094553n,
      35414148408193423211735462210279743496150383633088801277383073160916938493843n,
      34878991678064119169442084900553828397218924682387406243917099230599401148780n,
      45346946315156029274559984727839893164095325411430702636442359717481210321511n,
      15124591556122426477309540660897919468857997846316639835491587319990778094553n,
      35414148408193423211735462210279743496150383633088801277383073160916938493843n,
      34878991678064119169442084900553828397218924682387406243917099230599401148780n,
      45346946315156029274559984727839893164095325411430702636442359717481210321511n,
      15124591556122426477309540660897919468857997846316639835491587319990778094553n,
      35414148408193423211735462210279743496150383633088801277383073160916938493843n,
      34878991678064119169442084900553828397218924682387406243917099230599401148780n,
      45346946315156029274559984727839893164095325411430702636442359717481210321511n,
      34878991678064119169442084900553828397218924682387406243917099230599401148780n,
      45346946315156029274559984727839893164095325411430702636442359717481210321511n,
      15124591556122426477309540660897919468857997846316639835491587319990778094553n,
      35414148408193423211735462210279743496150383633088801277383073160916938493843n,
      34878991678064119169442084900553828397218924682387406243917099230599401148780n,
      45346946315156029274559984727839893164095325411430702636442359717481210321511n,
      15124591556122426477309540660897919468857997846316639835491587319990778094553n,
      35414148408193423211735462210279743496150383633088801277383073160916938493843n,
      34878991678064119169442084900553828397218924682387406243917099230599401148780n,
      45346946315156029274559984727839893164095325411430702636442359717481210321511n,
      15124591556122426477309540660897919468857997846316639835491587319990778094553n,
      35414148408193423211735462210279743496150383633088801277383073160916938493843n,
      34878991678064119169442084900553828397218924682387406243917099230599401148780n,
      45346946315156029274559984727839893164095325411430702636442359717481210321511n,
      15124591556122426477309540660897919468857997846316639835491587319990778094553n,
      35414148408193423211735462210279743496150383633088801277383073160916938493843n,
      34878991678064119169442084900553828397218924682387406243917099230599401148780n,
      45346946315156029274559984727839893164095325411430702636442359717481210321511n,
      34878991678064119169442084900553828397218924682387406243917099230599401148780n,
      45346946315156029274559984727839893164095325411430702636442359717481210321511n,
      15124591556122426477309540660897919468857997846316639835491587319990778094553n,
      35414148408193423211735462210279743496150383633088801277383073160916938493843n,
      34878991678064119169442084900553828397218924682387406243917099230599401148780n,
      45346946315156029274559984727839893164095325411430702636442359717481210321511n,
      15124591556122426477309540660897919468857997846316639835491587319990778094553n,
      35414148408193423211735462210279743496150383633088801277383073160916938493843n,
      34878991678064119169442084900553828397218924682387406243917099230599401148780n,
      45346946315156029274559984727839893164095325411430702636442359717481210321511n,
      15124591556122426477309540660897919468857997846316639835491587319990778094553n,
      35414148408193423211735462210279743496150383633088801277383073160916938493843n,
      34878991678064119169442084900553828397218924682387406243917099230599401148780n,
      45346946315156029274559984727839893164095325411430702636442359717481210321511n,
      15124591556122426477309540660897919468857997846316639835491587319990778094553n,
      35414148408193423211735462210279743496150383633088801277383073160916938493843n,
      34878991678064119169442084900553828397218924682387406243917099230599401148780n,
      45346946315156029274559984727839893164095325411430702636442359717481210321511n,
      34878991678064119169442084900553828397218924682387406243917099230599401148780n,
      45346946315156029274559984727839893164095325411430702636442359717481210321511n,
    ];
    console.log("ring_: ", ring_.length);
    console.log("responses: ", responses.length);

    const c: BigNumberish = 74610706691050711005030728000883340528711215420124158551449112834011240238290n;

    // console.log("message: ", message);
    // console.log("c: ", c);
    // console.log("ring: ", ring_);
    // console.log("responses: ", responses);
    console.log("output: ", await SigVerifier.verifyRingSignature(message, ring_, responses, c));
    // expect(await SigVerifier.verifyRingSignature(message, ring_, responses, c)).to.equal(true);
  });
});
